

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="English" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="English" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Beginners Guide &mdash; sangeranalyseR  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Advanced User Guide - SangerRead (AB1)" href="advance_user_SangerRead_ab1.html" />
    <link rel="prev" title="Quick Start Guide" href="quickstart.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> sangeranalyseR
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quick Start Guide</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Beginners Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#step-1-preparing-your-input-files">Step 1: Preparing your input files</a></li>
<li class="toctree-l2"><a class="reference internal" href="#step-2-loading-and-analysing-your-data">Step 2: Loading and analysing your data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#step-3-exploring-your-data-with-the-shiny-app">Step 3: Exploring your data with the Shiny app</a></li>
<li class="toctree-l2"><a class="reference internal" href="#step-4-outputting-your-aligned-contigs">Step 4: Outputting your aligned contigs</a></li>
<li class="toctree-l2"><a class="reference internal" href="#step-5-generating-an-interactive-report">Step 5: Generating an interactive report</a></li>
<li class="toctree-l2"><a class="reference internal" href="#what-s-next">What's next ?</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="advance_user_SangerRead_ab1.html">Advanced User Guide - <em>SangerRead</em> (<strong>AB1</strong>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="advance_user_SangerContig_ab1.html">Advanced User Guide - <em>SangerContig</em> (<strong>AB1</strong>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="advance_user_SangerAlignment_ab1.html">Advanced User Guide - <em>SangerAlignment</em> (<strong>AB1</strong>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="advance_user_SangerRead_fasta.html">Advanced User Guide - <em>SangerRead</em> (<strong>FASTA</strong>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="advance_user_SangerContig_fasta.html">Advanced User Guide - <em>SangerContig</em> (<strong>FASTA</strong>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="advance_user_SangerAlignment_fasta.html">Advanced User Guide - <em>SangerAlignment</em> (<strong>FASTA</strong>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="conclusion.html">Conclusion</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="contact.html">Contact</a></li>
<li class="toctree-l1"><a class="reference internal" href="help.html">Help</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">sangeranalyseR</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Beginners Guide</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/content/beginner.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="beginners-guide">
<h1>Beginners Guide<a class="headerlink" href="#beginners-guide" title="Permalink to this headline">¶</a></h1>
<p>If you haven't already, please follow the steps in the <a class="reference internal" href="installation.html#installation"><span class="std std-ref">Installation</span></a> page to install and load sangeranalyseR.</p>
<p>This guide is for users who are starting with <code class="code docutils literal notranslate"><span class="pre">.ab1</span></code> files. If you are starting with <strong>FASTA</strong> files, please read through this guide then follow the slightly different path for those starting with FASTA data here: <a class="reference internal" href="advance_user_SangerAlignment_fasta.html#advanced-user-guide-sangeralignment-fasta"><span class="std std-ref">Advanced User Guide - SangerAlignment (FASTA)</span></a>.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="section" id="step-1-preparing-your-input-files">
<h2>Step 1: Preparing your input files<a class="headerlink" href="#step-1-preparing-your-input-files" title="Permalink to this headline">¶</a></h2>
<p>sangeranalyseR takes as input a group of <strong>.ab1</strong> files, which it then groups together into contigs. Once the individual contigs are built, all the contigs are aligned and a simple phylogenetic tree is made. This section explains how you should organize your files before running sangeranalyseR.</p>
<p>First, prepare a directory and put all your <strong>.ab1</strong> files inside it (there can be other files in there too, sangeranalyseR will ignore anything without a <cite>.ab1</cite> file extension). Files can be organised in as many sub-folders as you like. sangeranalyseR will recursively search all the directories inside <code class="code docutils literal notranslate"><span class="pre">parentDirectory</span></code> and find all files that end with <strong>.ab1</strong>.</p>
<p>Second, give sangeranalyseR the information it needs to group reads into contigs. To do this, sangeranalyseR needs two pieces of information about each read: the direction of the read (forward or reverse), and the contig that it should be grouped into. There are two ways you can give sangeranalyseR this information:</p>
<ul class="simple">
<li><p>using the file name itself</p></li>
<li><p>using a three-column csv file</p></li>
</ul>
<p>We'll cover both approaches using the following example. Imagine you have sequenced four contigs with a forward and reverse read, all from the same species, but from different locations. In this case you might have arranged your data something like <a class="reference internal" href="#sangeralignment-file-structure-beginner"><span class="std std-ref">Figure_1</span></a>, below.</p>
<div class="figure align-center" id="id1">
<span id="sangeralignment-file-structure-beginner"></span><a class="reference internal image-reference" href="../_images/SangerAlignment_file_structure_beginner.png"><img alt="../_images/SangerAlignment_file_structure_beginner.png" src="../_images/SangerAlignment_file_structure_beginner.png" style="width: 319.0px; height: 385.0px;" /></a>
<p class="caption"><span class="caption-text">Figure 1. Input ab1 files inside the parent directory, <code class="code docutils literal notranslate"><span class="pre">./tmp/</span></code>.</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</div>
<p>When using the filenames to group the reads, you'll need to specify three parameters: <code class="code docutils literal notranslate"><span class="pre">parentDirectory</span></code>, <code class="code docutils literal notranslate"><span class="pre">suffixForwardRegExp</span></code>, and <code class="code docutils literal notranslate"><span class="pre">suffixReverseRegExp</span></code>:</p>
<ul class="simple">
<li><p><code class="code docutils literal notranslate"><span class="pre">parentDirectory</span></code>: this is the directory that contains all the <strong>.ab1</strong> files. In this example, the reads are in the <code class="code docutils literal notranslate"><span class="pre">/tmp/</span></code> directory, so for convenience we'll just say that <code class="code docutils literal notranslate"><span class="pre">parentDirectory</span></code> should be <code class="code docutils literal notranslate"><span class="pre">/path/to/tmp/</span></code>. In your case, it should be the absolute path to the folder that contains your reads.</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">suffixForwardRegExp</span></code>: This is a regular expression (if you don't know what this is, don't panic - it's just a way of recognising text that you will get the hang of fast), which tells sangeranalyseR how to use the end of a filename to determine a forward read. All the reads that are in forward direction have to contain this in their filename suffix. There are lots of ways to do this, but for this example, one uesful way to do it is <code class="code docutils literal notranslate"><span class="pre">_[0-9]+_F</span></code>. This regular expression just says that the forward suffix is an underscore, followed at least one digit from 0-9, followed by another underscore then 'F'. The regex does not have to match to the end of the file name, but it's important to realise is that whatever comes before the part of the filename captured by this regex is by default the contig name. So in this case the regex also determines that the contig name for the first read is 'Achl_RBNII397-13'.</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">suffixReverseRegExp</span></code>: This is just the same as for the forward read, except that it determines the suffix for reverse reads. All the reads that are in reverse direction have to contain this in their filename suffix. In this example, its value is <code class="code docutils literal notranslate"><span class="pre">_[0-9]+_R</span></code>. I.e. all we've done is switch the 'F' in the forward read for an 'R' in the reverse read.</p></li>
</ul>
<p>If you don't want to use the regex method, you can use the csv method instead. To use this method, just prepare an input <strong>.csv</strong> file with three columns:</p>
<ul class="simple">
<li><p>contig: the name of the contig that reads should be grouped into</p></li>
<li><p>direction: &quot;F&quot; or &quot;R&quot; for forward and reverse reads, respectively</p></li>
<li><p>reads: the full file name (just the name, not the path) of the read to be grouped</p></li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="step-2-loading-and-analysing-your-data">
<h2>Step 2: Loading and analysing your data<a class="headerlink" href="#step-2-loading-and-analysing-your-data" title="Permalink to this headline">¶</a></h2>
<p>After preparing the input files, you can create and align your contigs with just a single line of R code. In technical jargon, we are creating a <em>SangerAlignment</em> S4 instance.</p>
<p>It's important to note that this function is designed to be both <em>simple</em> and <em>flexible</em>. It's simple in that it has sensible defaults for all the usual things like trimming reads. But it's flexible in that you can change any and all of these defaults to suit your particular data and analyses. Here we just cover the simplest usage. The more flexible things are covered in the Advanced sections of the user guide.</p>
<p>So, let's create our contigs from our reads, and align them.</p>
<p>Here's how to do it using the regex method:</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="n">my_aligned_contigs</span> <span class="o">&lt;-</span> <span class="nf">SangerAlignment</span><span class="p">(</span><span class="n">parentDirectory</span>     <span class="o">=</span> <span class="s">&quot;/path/to/tmp/&quot;</span><span class="p">,</span>
                                      <span class="n">suffixForwardRegExp</span> <span class="o">=</span> <span class="s">&quot;_[0-9]+_F&quot;</span><span class="p">,</span>
                                      <span class="n">suffixReverseRegExp</span> <span class="o">=</span> <span class="s">&quot;_[0-9]+_R&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Here's how to do it using the csv file method</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="n">my_aligned_contigs</span> <span class="o">&lt;-</span> <span class="nf">SangerAlignment</span><span class="p">(</span><span class="n">parentDirectory</span>     <span class="o">=</span> <span class="s">&quot;/path/to/tmp/&quot;</span><span class="p">,</span>
                                      <span class="n">namesConversionCSV</span>  <span class="o">=</span> <span class="s">&quot;/path/to/csvfile&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="code docutils literal notranslate"><span class="pre">my_aligned_contigs</span></code> is now a <em>SangerAlignment</em> S4 object which contains all of your reads, all the information on how they were trimmed, processed, and aligned, their chromatograms, and an alignment and phylogeny of all of your assembled contigs. The next section explains how to start digging into the details of that object.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="step-3-exploring-your-data-with-the-shiny-app">
<h2>Step 3: Exploring your data with the Shiny app<a class="headerlink" href="#step-3-exploring-your-data-with-the-shiny-app" title="Permalink to this headline">¶</a></h2>
<p>sangeranalseR includes a Shiny app that allows you to see, interact with, and adjust the parameters of your aligned contigs. For example, you can adjust things like the trimming parameters, and see how that changes your reads and your contigs.</p>
<p>To launch the interactive Shiny app use the <code class="code docutils literal notranslate"><span class="pre">launchApp</span></code> function as follows</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">launchApp</span><span class="p">(</span><span class="n">my_aligned_contigs</span><span class="p">)</span>
</pre></div>
</div>
<div class="figure align-center" id="id2">
<span id="sangeralignment-shiny-app"></span><img alt="../_images/SangerAlignment_shiny_app.png" src="../_images/SangerAlignment_shiny_app.png" />
<p class="caption"><span class="caption-text">Figure 2. <em>SangerAlignment</em> Shiny app user interface.</span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</div>
<p><a class="reference internal" href="#sangeralignment-shiny-app"><span class="std std-ref">Figure_2</span></a> shows what the Shiny app looks like. On the left-hand side of <a class="reference internal" href="#sangeralignment-shiny-app"><span class="std std-ref">Figure_2</span></a>, there is a navigation menu that you can click to get more detail on every contig and every read. You can explore this app to get a lot more detail and make adjustments to your data. (Note that sangeranalyseR doesn't allow for editing individual bases of reads though - that's just not something that R is good for).</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="step-4-outputting-your-aligned-contigs">
<h2>Step 4: Outputting your aligned contigs<a class="headerlink" href="#step-4-outputting-your-aligned-contigs" title="Permalink to this headline">¶</a></h2>
<p>Once you're happy with your aligned contigs, you'll want to save them somewhere.</p>
<p>The following function can write the <em>SangerAlignment</em> object as a FASTA file. You just need to tell it where with the <code class="code docutils literal notranslate"><span class="pre">outputDir</span></code> argument. Here we just wrote the alignment to the same folder that contains our reads.</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">writeFasta</span><span class="p">(</span><span class="n">my_aligned_contigs</span><span class="p">,</span> <span class="n">outputDir</span> <span class="o">=</span> <span class="s">&quot;/path/to/tmp/&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="step-5-generating-an-interactive-report">
<h2>Step 5: Generating an interactive report<a class="headerlink" href="#step-5-generating-an-interactive-report" title="Permalink to this headline">¶</a></h2>
<p>Last but not least, it is useful to store all the results in a report for future reference. You can generate a detailed report by running the following one-line function. <a class="reference internal" href="#sangeralignment-alignment-result"><span class="std std-ref">Figure_3</span></a> and <a class="reference internal" href="#sangeralignment-tree"><span class="std std-ref">Figure_4</span></a>.</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">generateReport</span><span class="p">(</span><span class="n">my_aligned_contigs</span><span class="p">)</span>
</pre></div>
</div>
<div class="figure align-center" id="id3">
<span id="sangeralignment-alignment-result"></span><img alt="../_images/SangerAlignment_alignment_result.png" src="../_images/SangerAlignment_alignment_result.png" />
<p class="caption"><span class="caption-text">Figure 3. An alignment of all contigs in the <em>SangerAlignment</em> object.</span><a class="headerlink" href="#id3" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-center" id="id4">
<span id="sangeralignment-tree"></span><a class="reference internal image-reference" href="../_images/SangerAlignment_tree.png"><img alt="../_images/SangerAlignment_tree.png" src="../_images/SangerAlignment_tree.png" style="width: 547.1999999999999px; height: 160.2px;" /></a>
<p class="caption"><span class="caption-text">Figure 4. A phylogenetic tree with contigs as the leaf nodes. This can help diagnose any issues with your contigs.</span><a class="headerlink" href="#id4" title="Permalink to this image">¶</a></p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="what-s-next">
<h2>What's next ?<a class="headerlink" href="#what-s-next" title="Permalink to this headline">¶</a></h2>
<p>Now you've finished the <a class="reference internal" href="#beginners-guide"><span class="std std-ref">Beginners Guide</span></a>, you should have a good overview of how to use the package. To dig a lot deeper into what you can do and why you might bother, there are also a set of advanced guides that focus on the three levels at which you can analyse Sanger data in the sangeranalyseR package. You can analyse individual reads with the <em>SangerRead</em> object, individual contigs with the <em>SangerContig</em> object, and alignments of two or more contigs (as we focussed on in this intro) with teh <em>SangerAlignment</em> object.</p>
<p>If you want to start the analysis from <strong>AB1</strong> files, please choose the analysis level and read the following three links.</p>
<ul class="simple">
<li><p><a class="reference internal" href="advance_user_SangerRead_ab1.html#advanced-user-guide-sangerread-ab1"><span class="std std-ref">Advanced User Guide - SangerRead (AB1)</span></a></p></li>
<li><p><a class="reference internal" href="advance_user_SangerContig_ab1.html#advanced-user-guide-sangercontig-ab1"><span class="std std-ref">Advanced User Guide - SangerContig (AB1)</span></a></p></li>
<li><p><a class="reference internal" href="advance_user_SangerAlignment_ab1.html#advanced-user-guide-sangeralignment-ab1"><span class="std std-ref">Advanced User Guide - SangerAlignment (AB1)</span></a></p></li>
</ul>
<p>If you want to start the analysis from <strong>FASTA</strong> files, please choose the analysis level and read the following three links.</p>
<ul class="simple">
<li><p><a class="reference internal" href="advance_user_SangerRead_fasta.html#advanced-user-guide-sangerread-fasta"><span class="std std-ref">Advanced User Guide - SangerRead (FASTA)</span></a></p></li>
<li><p><a class="reference internal" href="advance_user_SangerContig_fasta.html#advanced-user-guide-sangercontig-fasta"><span class="std std-ref">Advanced User Guide - SangerContig (FASTA)</span></a></p></li>
<li><p><a class="reference internal" href="advance_user_SangerAlignment_fasta.html#advanced-user-guide-sangeralignment-fasta"><span class="std std-ref">Advanced User Guide - SangerAlignment (FASTA)</span></a></p></li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="advance_user_SangerRead_ab1.html" class="btn btn-neutral float-right" title="Advanced User Guide - SangerRead (AB1)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="quickstart.html" class="btn btn-neutral float-left" title="Quick Start Guide" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Kuan-Hao Chao

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>