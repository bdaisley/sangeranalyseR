

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="English" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="English" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Advanced User Guide - SangerAlignment &mdash; sangeranalyseR  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Conclusion" href="conclusion.html" />
    <link rel="prev" title="Advanced User Guide - SangerContig" href="advance_user_SangerContig.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> sangeranalyseR
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_start.html">Getting Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="quick_commands.html">Quick Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="beginner.html">Beginner Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="advance_user_SangerRead.html">Advanced User Guide - <em>SangerRead</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="advance_user_SangerContig.html">Advanced User Guide - <em>SangerContig</em></a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Advanced User Guide - <em>SangerAlignment</em></a><ul>
<li class="toctree-l2"><a class="reference internal" href="#input-files-preparation">Input files preparation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#ab1-files">ab1 files</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fasta-files">FASTA files</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#sangeralignment-creation"><em>SangerAlignment</em> creation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#inputs-slots-definition">Inputs &amp; Slots Definition</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#update-quality-trimming-parameters">Update quality trimming parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="#sangeralignment-shiny-app"><em>SangerAlignment</em> Shiny app</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#sangeralignment-page"><em>SangerAlignment</em> Page</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sangercontig-page"><em>SangerContig</em> Page</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sangerread-page"><em>SangerRead</em> Page</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#writing-fasta-files">Writing FASTA files</a></li>
<li class="toctree-l2"><a class="reference internal" href="#generating-sangeralignment-report">Generating <em>SangerAlignment</em> report</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="conclusion.html">Conclusion</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="contact.html">Contact</a></li>
<li class="toctree-l1"><a class="reference internal" href="help.html">Help</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">sangeranalyseR</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Advanced User Guide - <em>SangerAlignment</em></li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/content/advance_user_SangerAlignment.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="advanced-user-guide-sangeralignment">
<h1>Advanced User Guide - <em>SangerAlignment</em><a class="headerlink" href="#advanced-user-guide-sangeralignment" title="Permalink to this headline">¶</a></h1>
<p><em>SangerAlignment</em> is the highest class level in sangeranalyseR showed in <a class="reference internal" href="#sangeralignment-hierachy"><span class="std std-ref">Figure_1</span></a>. It contains <em>SangerContig</em> list and the contigs alignment result. Users can access to <em>SangerContig</em> and <em>SangerRead</em> instance inside <em>SangerAlignment</em> instance. In this section, we are going to go through detailed sangeranalyseR data analysis steps in <em>SangerAlignment</em> level.</p>
<div class="figure align-center" id="id1">
<span id="sangeralignment-hierachy"></span><a class="reference internal image-reference" href="../_images/SangerAlignment_hierachy.png"><img alt="../_images/SangerAlignment_hierachy.png" src="../_images/SangerAlignment_hierachy.png" style="width: 545.4px; height: 218.8px;" /></a>
<p class="caption"><span class="caption-text">Figure 1. Classes hierarchy in sangeranalyseR, <em>SangerAlignment</em> level.</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="section" id="input-files-preparation">
<h2>Input files preparation<a class="headerlink" href="#input-files-preparation" title="Permalink to this headline">¶</a></h2>
<p>Users can choose to input <strong>ab1</strong> or <strong>FASTA</strong> as their input file format.</p>
<div class="section" id="ab1-files">
<h3>ab1 files<a class="headerlink" href="#ab1-files" title="Permalink to this headline">¶</a></h3>
<p>The main input file format to create <em>SangerAlignment</em> instance is <strong>ab1</strong>. Before starting the analysis, users needs to prepare a directory which contains all the <strong>ab1</strong> files. Here are some filename regulations:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>All the input files must have <strong>ab1</strong> as its file extension</p></li>
<li><p>The reads that belong to the same contig must have the same contig name in its filename.</p></li>
<li><p>Forward or reverse direction also needs to be specified in the filename.</p></li>
</ul>
</div>
<p>There are three parameters, <code class="code docutils literal notranslate"><span class="pre">parentDirectory</span></code>, <code class="code docutils literal notranslate"><span class="pre">suffixForwardRegExp</span></code>, and <code class="code docutils literal notranslate"><span class="pre">suffixReverseRegExp</span></code>, that users need to provide so that program can automatically group all <strong>ab1</strong> files.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p><code class="code docutils literal notranslate"><span class="pre">parentDirectory</span></code> is the root directory that contains all the <strong>ab1</strong> files. It can be absolute or relative path. We suggest users to put only target <strong>ab1</strong> files inside this directory without other unrelated files.</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">suffixForwardRegExp</span></code>: The value of this parameter is a regular expression that matches all filename in forward direction. <code class="code docutils literal notranslate"><span class="pre">grepl</span></code> function in R is used to select forward reads from all <strong>ab1</strong> files.</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">suffixReverseRegExp</span></code>: The value of this parameter is a regular expression that matches all filename in reverse direction. <code class="code docutils literal notranslate"><span class="pre">grepl</span></code> function in R is used to select reverse reads from all <strong>ab1</strong> files.</p></li>
</ul>
</div>
<p>For basic input files preparation example, please go to <a class="reference internal" href="beginner.html#beginner-guide"><span class="std std-ref">Beginner Guide</span></a>. Here, we have another more complicated example.</p>
<div class="figure align-center" id="id2">
<span id="sangeralignment-file-structure-complex"></span><a class="reference internal image-reference" href="../_images/SangerAlignment_file_structure_complex.png"><img alt="../_images/SangerAlignment_file_structure_complex.png" src="../_images/SangerAlignment_file_structure_complex.png" style="width: 477.59999999999997px; height: 708.0px;" /></a>
<p class="caption"><span class="caption-text">Figure 2. Input ab1 files inside the parent directory, <code class="code docutils literal notranslate"><span class="pre">./tmp/</span></code>.</span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</div>
<p><a class="reference internal" href="#sangeralignment-file-structure-complex"><span class="std std-ref">Figure_1</span></a> shows the file naming convention and directory hierarchy. In this example, the parent directory is <code class="code docutils literal notranslate"><span class="pre">extdata</span></code> and the directories in first layer are <code class="code docutils literal notranslate"><span class="pre">Allolobophora_chlorotica</span></code> and <code class="code docutils literal notranslate"><span class="pre">Drosophila_melanogaster</span></code>. All target <strong>ab1</strong> files need to be inside parent directory but it is not necessary to put them in the same level of directory. sangeranalyseR will recursively search all files with <strong>.ab1</strong> file extension and automatically group reads with the same contig name. The direction of reads in each contig will be grouped by matching <code class="code docutils literal notranslate"><span class="pre">suffixForwardRegExp</span></code> and <code class="code docutils literal notranslate"><span class="pre">suffixReverseRegExp</span></code> with filenames. Therefore, it is important to carefully select <code class="code docutils literal notranslate"><span class="pre">suffixForwardRegExp</span></code> and <code class="code docutils literal notranslate"><span class="pre">suffixReverseRegExp</span></code>. The bad file naming and wrong regex matching might accidentally include reverse reads into the forward read list or vice versa, which will make the program generate totally wrong results. Therefore, users should have a consistent naming strategy. In this example, <code class="code docutils literal notranslate"><span class="pre">&quot;_[0-9]*_F.ab1$&quot;</span></code>, <code class="code docutils literal notranslate"><span class="pre">&quot;_[0-9]*_R.ab1$&quot;</span></code> for matching forward and reverse reads are highly suggested and are used as default. It is a good habit to index your reads in the same contig group because there might be more than one read that are in the forward or reverse direction.</p>
<div class="figure align-center" id="id3">
<span id="sangeralignment-filename-convention"></span><a class="reference internal image-reference" href="../_images/SangerAlignment_filename_convention.png"><img alt="../_images/SangerAlignment_filename_convention.png" src="../_images/SangerAlignment_filename_convention.png" style="width: 621.0px; height: 28.0px;" /></a>
<p class="caption"><span class="caption-text">Figure 2. Suggested <strong>ab1</strong> file naming convention.</span><a class="headerlink" href="#id3" title="Permalink to this image">¶</a></p>
</div>
<p><a class="reference internal" href="#sangeralignment-filename-convention"><span class="std std-ref">Figure_2</span></a> shows the suggested <strong>ab1</strong> file naming convention. Users are strongly recommended to follow this file naming convention and use the default <code class="code docutils literal notranslate"><span class="pre">suffixForwardRegExp</span></code> : <code class="code docutils literal notranslate"><span class="pre">&quot;_[0-9]*_F.ab1$&quot;</span></code> and <code class="code docutils literal notranslate"><span class="pre">suffixReverseRegExp</span></code> : <code class="code docutils literal notranslate"><span class="pre">&quot;_[0-9]*_R.ab1$&quot;</span></code> to reduce any chance of error.</p>
</div>
<div class="section" id="fasta-files">
<h3>FASTA files<a class="headerlink" href="#fasta-files" title="Permalink to this headline">¶</a></h3>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
</div>
<div class="section" id="sangeralignment-creation">
<h2><em>SangerAlignment</em> creation<a class="headerlink" href="#sangeralignment-creation" title="Permalink to this headline">¶</a></h2>
<p>After preparing the input directory, we can create the <em>SangerAlignment</em> S4 instance by running <code class="code docutils literal notranslate"><span class="pre">SangerAlignment</span></code> constructor function or <code class="code docutils literal notranslate"><span class="pre">new</span></code> method. The constructor function is a wrapper for <code class="code docutils literal notranslate"><span class="pre">new</span></code> method and it make instance creation more intuitive. Most parameters in the constructor have their own default values. In the constructor below, we list all possible parameters that users can assign. For a simpler command, please go to <a class="reference internal" href="quick_commands.html#quick-commands"><span class="std std-ref">Quick Commands</span></a>.</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="n">sangerAlignment</span> <span class="o">&lt;-</span> <span class="nf">SangerAlignment</span><span class="p">(</span><span class="n">inputSource</span>          <span class="o">=</span> <span class="s">&quot;ABIF&quot;</span><span class="p">,</span>
                                   <span class="n">parentDirectory</span>      <span class="o">=</span> <span class="s">&quot;./tmp/&quot;</span><span class="p">,</span>
                                   <span class="n">suffixForwardRegExp</span>  <span class="o">=</span> <span class="s">&quot;_[0-9]*_F.ab1$&quot;</span><span class="p">,</span>
                                   <span class="n">suffixReverseRegExp</span>  <span class="o">=</span> <span class="s">&quot;_[0-9]*_R.ab1$&quot;</span><span class="p">,</span>
                                   <span class="n">refAminoAcidSeq</span>      <span class="o">=</span> <span class="s">&quot;SRQWLFSTNHKDIGTLYFIFGAWAGMVGTSLSILIRAELGHPGALIGDDQIYNVIVTAHAFIMIFFMVMPIMIGGFGNWLVPLMLGAPDMAFPRMNNMSFWLLPPALSLLLVSSMVENGAGTGWTVYPPLSAGIAHGGASVDLAIFSLHLAGISSILGAVNFITTVINMRSTGISLDRMPLFVWSVVITALLLLLSLPVLAGAITMLLTDRNLNTSFFDPAGGGDPILYQHLFWFFGHPEVYILILPGFGMISHIISQESGKKETFGSLGMIYAMLAIGLLGFIVWAHHMFTVGMDVDTRAYFTSATMIIAVPTGIKIFSWLATLHGTQLSYSPAILWALGFVFLFTVGGLTGVVLANSSVDIILHDTYYVVAHFHYVLSMGAVFAIMAGFIHWYPLFTGLTLNNKWLKSHFIIMFIGVNLTFFPQHFLGLAGMPRRYSDYPDAYTTWNIVSTIGSTISLLGILFFFFIIWESLVSQRQVIYPIQLNSSIEWYQNTPPAEHSYSELPLLTN&quot;</span><span class="p">,</span>
                                   <span class="n">TrimmingMethod</span>        <span class="o">=</span> <span class="s">&quot;M1&quot;</span><span class="p">,</span>
                                   <span class="n">M1TrimmingCutoff</span>      <span class="o">=</span> <span class="m">0.0001</span><span class="p">,</span>
                                   <span class="n">M2CutoffQualityScore</span>  <span class="o">=</span> <span class="kc">NULL</span><span class="p">,</span>
                                   <span class="n">M2SlidingWindowSize</span>   <span class="o">=</span> <span class="kc">NULL</span><span class="p">,</span>
                                   <span class="n">baseNumPerRow</span>         <span class="o">=</span> <span class="m">100</span><span class="p">,</span>
                                   <span class="n">heightPerRow</span>          <span class="o">=</span> <span class="m">200</span><span class="p">,</span>
                                   <span class="n">signalRatioCutoff</span>     <span class="o">=</span> <span class="m">0.33</span><span class="p">,</span>
                                   <span class="n">showTrimmed</span>           <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span>
                                   <span class="n">minReadsNum</span>           <span class="o">=</span> <span class="m">2</span><span class="p">,</span>
                                   <span class="n">minReadLength</span>         <span class="o">=</span> <span class="m">20</span><span class="p">,</span>
                                   <span class="n">minFractionCall</span>       <span class="o">=</span> <span class="m">0.5</span><span class="p">,</span>
                                   <span class="n">maxFractionLost</span>       <span class="o">=</span> <span class="m">0.5</span><span class="p">,</span>
                                   <span class="n">geneticCode</span>           <span class="o">=</span> <span class="n">GENETIC_CODE</span><span class="p">,</span>
                                   <span class="n">acceptStopCodons</span>      <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span>
                                   <span class="n">readingFrame</span>          <span class="o">=</span> <span class="m">1</span><span class="p">,</span>
                                   <span class="n">minFractionCallSA</span>     <span class="o">=</span> <span class="m">0.5</span><span class="p">,</span>
                                   <span class="n">maxFractionLostSA</span>     <span class="o">=</span> <span class="m">0.5</span><span class="p">,</span>
                                   <span class="n">processorsNum</span>         <span class="o">=</span> <span class="kc">NULL</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="inputs-slots-definition">
<h3>Inputs &amp; Slots Definition<a class="headerlink" href="#inputs-slots-definition" title="Permalink to this headline">¶</a></h3>
<p>The inputs of <code class="code docutils literal notranslate"><span class="pre">SangerAlignment</span></code> constructor function and <code class="code docutils literal notranslate"><span class="pre">new</span></code> method are same. For more details, please refer to <a class="reference external" href="http://packages.python.org/an_example_pypi_project/">sangeranalyseR reference manul</a>.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
</div>
<div class="section" id="update-quality-trimming-parameters">
<h2>Update quality trimming parameters<a class="headerlink" href="#update-quality-trimming-parameters" title="Permalink to this headline">¶</a></h2>
<p>In the previous <a class="reference internal" href="#sangeralignment-creation"><span class="std std-ref">SangerAlignment creation</span></a> part, the constructor function will apply the quality trimming parameters to all reads. After creating the <em>SangerAlignment</em> S4 instance, users can change the trimming parameters by running <code class="code docutils literal notranslate"><span class="pre">updateQualityParam</span></code> function which will update all reads with the new trimming parameters and redo reads alignment in <em>SangerContig</em> and contigs alignment in <em>SangerAlignment</em>. If users want to do quality trimming read by read instead all at once, please read <a class="reference internal" href="#sangeralignment-shiny-app"><span class="std std-ref">SangerAlignment Shiny app</span></a>.</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="n">newSangerAlignment</span> <span class="o">&lt;-</span> <span class="nf">updateQualityParam</span><span class="p">(</span><span class="n">sangerAlignment</span><span class="p">,</span>
                                         <span class="n">TrimmingMethod</span>       <span class="o">=</span> <span class="s">&quot;M2&quot;</span><span class="p">,</span>
                                         <span class="n">M1TrimmingCutoff</span>     <span class="o">=</span> <span class="kc">NULL</span><span class="p">,</span>
                                         <span class="n">M2CutoffQualityScore</span> <span class="o">=</span> <span class="m">29</span><span class="p">,</span>
                                         <span class="n">M2SlidingWindowSize</span>  <span class="o">=</span> <span class="m">15</span><span class="p">)</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="sangeralignment-shiny-app">
<h2><em>SangerAlignment</em> Shiny app<a class="headerlink" href="#sangeralignment-shiny-app" title="Permalink to this headline">¶</a></h2>
<p>We create an interactive local Shiny app for users to go into each <em>SangerRead</em> and <em>SangerContig</em> in <em>SangerAlignment</em> instance. Users only need to run one function with previously created <em>SangerAlignment</em> S4 instance as input and the Shiny app will pop up. Here, we will go through each pages.</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">launchAppSA</span><span class="p">(</span><span class="n">sangerAlignment</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="sangeralignment-page">
<h3><em>SangerAlignment</em> Page<a class="headerlink" href="#sangeralignment-page" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="#sangeralignment-shinyapp-1"><span class="std std-ref">Figure 3</span></a> is the initial page and the toppest layer of SangerAlignment App. It provides basic parameters of <em>SangerAlignment</em>, contigs alignment result and classification tree etc. After updating all the trimmed reads, users need to remember to click “Re-calculate Contigs Alignment” button to do contigs alignment again. From the left-hand side panel, we can clearly see the hierarchy of the <em>SangerAlignment</em> S4 instance and easily access to all reads in it.</p>
<div class="figure align-center" id="id4">
<span id="sangeralignment-shinyapp-1"></span><a class="reference internal image-reference" href="../_images/SangerAlignment_ShinyApp_1.png"><img alt="../_images/SangerAlignment_ShinyApp_1.png" src="../_images/SangerAlignment_ShinyApp_1.png" style="width: 720.0px; height: 394.0px;" /></a>
<p class="caption"><span class="caption-text">Figure 3. <em>SangerAlignment</em> app initial page.</span><a class="headerlink" href="#id4" title="Permalink to this image">¶</a></p>
</div>
<p>Scroll down a bit, users can see the contigs alignment result generated by <a class="reference external" href="https://bioconductor.org/packages/release/bioc/html/DECIPHER.html">DECIPHER</a> R package embedded in <em>SangerAlignment</em> page. <a class="reference internal" href="#sangeralignment-shinyapp-2"><span class="std std-ref">Figure 4</span></a> shows the contigs alignment result.</p>
<div class="figure align-center" id="id5">
<span id="sangeralignment-shinyapp-2"></span><a class="reference internal image-reference" href="../_images/SangerAlignment_ShinyApp_2.png"><img alt="../_images/SangerAlignment_ShinyApp_2.png" src="../_images/SangerAlignment_ShinyApp_2.png" style="width: 672.6px; height: 416.4px;" /></a>
<p class="caption"><span class="caption-text">Figure 4. <em>SangerAlignment</em> contigs alignment result.</span><a class="headerlink" href="#id5" title="Permalink to this image">¶</a></p>
</div>
<p>In <em>SangerAlignment</em> page, there is a phylogenetic tree result as well. The tree is generated by <a class="reference external" href="https://cran.r-project.org/web/packages/ape/index.html">ape</a> R package which uses NJ algorithm.</p>
<div class="figure align-center" id="id6">
<span id="sangeralignment-shinyapp-3"></span><a class="reference internal image-reference" href="../_images/SangerAlignment_ShinyApp_3.png"><img alt="../_images/SangerAlignment_ShinyApp_3.png" src="../_images/SangerAlignment_ShinyApp_3.png" style="width: 927.5999999999999px; height: 361.2px;" /></a>
<p class="caption"><span class="caption-text">Figure 5. <em>SangerAlignment</em> phylogenetic tree result.</span><a class="headerlink" href="#id6" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="sangercontig-page">
<h3><em>SangerContig</em> Page<a class="headerlink" href="#sangercontig-page" title="Permalink to this headline">¶</a></h3>
<p>Now, let's go to the next level, <em>SangerContig</em>. Users can click into all contigs and check their results. <a class="reference internal" href="#sangeralignment-shinyapp-5"><span class="std std-ref">Figure 7</span></a> shows the overview page of Contig 1. Notice that there is a red “Re-calculate Contig” button. After changing the read trimming parameters, users need to click the button before checking the results in order to get the updated information.</p>
<div class="figure align-center" id="id7">
<span id="sangeralignment-shinyapp-5"></span><a class="reference internal image-reference" href="../_images/SangerAlignment_ShinyApp_5.png"><img alt="../_images/SangerAlignment_ShinyApp_5.png" src="../_images/SangerAlignment_ShinyApp_5.png" style="width: 720.0px; height: 394.0px;" /></a>
<p class="caption"><span class="caption-text">Figure 7. <em>SangerAlignment</em> - <em>SangerContig</em> page.</span><a class="headerlink" href="#id7" title="Permalink to this image">¶</a></p>
</div>
<p>The information provided in this page includes : “input parameters”, “genetic code table”, “reference amino acid sequence”, “reads alignment”, “difference data frame”, “dendrogram”, “sample distance heatmap”, “indels data frame”, “stop codons data frame”. <a class="reference internal" href="#sangeralignment-shinyapp-6"><span class="std std-ref">Figure 8</span></a> and <a class="reference internal" href="#sangeralignment-shinyapp-7"><span class="std std-ref">Figure 9</span></a> show part of the results in the <em>SangerContig</em> page. The results are dynamic based on the trimming parameters from user inputs.</p>
<div class="figure align-center" id="id8">
<span id="sangeralignment-shinyapp-6"></span><a class="reference internal image-reference" href="../_images/SangerAlignment_ShinyApp_6.png"><img alt="../_images/SangerAlignment_ShinyApp_6.png" src="../_images/SangerAlignment_ShinyApp_6.png" style="width: 638.4px; height: 472.2px;" /></a>
<p class="caption"><span class="caption-text">Figure 8. Contig related parameters, genetic code and reference amino acid sequence.</span><a class="headerlink" href="#id8" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-center" id="id9">
<span id="sangeralignment-shinyapp-7"></span><a class="reference internal image-reference" href="../_images/SangerAlignment_ShinyApp_7.png"><img alt="../_images/SangerAlignment_ShinyApp_7.png" src="../_images/SangerAlignment_ShinyApp_7.png" style="width: 672.0px; height: 472.79999999999995px;" /></a>
<p class="caption"><span class="caption-text">Figure 9. Reads alignment and difference data frame.</span><a class="headerlink" href="#id9" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="sangerread-page">
<h3><em>SangerRead</em> Page<a class="headerlink" href="#sangerread-page" title="Permalink to this headline">¶</a></h3>
<p>Now, let's go to the lowest level, <em>SangerRead</em>. <em>SangerRead</em> page contains all details of a read including its trimming and chromatogram inputs and results. All reads are in &quot;forward&quot; or &quot;reverse&quot; direction. Under <em>SangerContig</em> page, there are two expendable tabs, “Forward Reads” and “Reverse Reads” storing the corresponding reads in the left-hand side navigation panel. In this example, there are one read in each tab and <a class="reference internal" href="#sangeralignment-shinyapp-8"><span class="std std-ref">Figure 10</span></a> shows the “1 - 1 Forward Read” page. It provides basic information, quality trimming inputs, chromatogram plotting inputs etc. Primary/secondary sequences in this figure are dynamic based on the <code class="code docutils literal notranslate"><span class="pre">signalRatioCutoff</span></code> value for base calling and the length of them are always same. Another thing to mention is that primary/secondary sequences and the sequences in the chromatogram in <a class="reference internal" href="#sangeralignment-shinyapp-14"><span class="std std-ref">Figure 16</span></a> below are same and the color coding for A/T/C/G is same as well.</p>
<div class="figure align-center" id="id10">
<span id="sangeralignment-shinyapp-8"></span><a class="reference internal image-reference" href="../_images/SangerAlignment_ShinyApp_8.png"><img alt="../_images/SangerAlignment_ShinyApp_8.png" src="../_images/SangerAlignment_ShinyApp_8.png" style="width: 720.0px; height: 394.0px;" /></a>
<p class="caption"><span class="caption-text">Figure 10. <em>SangerAlignment</em> - <em>SangerRead</em> page.</span><a class="headerlink" href="#id10" title="Permalink to this image">¶</a></p>
</div>
<p>In quality trimming steps, we removes fragment at both ends of sequencing reads with low quality score. It is important because trimmed reads would improves alignment results. <a class="reference internal" href="#sangeralignment-shinyapp-9"><span class="std std-ref">Figure 11</span></a> shows the UI for Trimming Method 1 (M1): ‘Logarithmic Scale Trimming’. Users can change the cutoff score and click “Apply Trimming Parameters&quot; button to update the UI. The value of input must be between 0 and 1. If the input is invalid, the cutoff score will be set to default 0.0001.</p>
<div class="figure align-center" id="id11">
<span id="sangeralignment-shinyapp-9"></span><a class="reference internal image-reference" href="../_images/SangerAlignment_ShinyApp_9.png"><img alt="../_images/SangerAlignment_ShinyApp_9.png" src="../_images/SangerAlignment_ShinyApp_9.png" style="width: 722.7px; height: 281.25px;" /></a>
<p class="caption"><span class="caption-text">Figure 11. <em>SangerRead</em> page - Trimming Method 1 (M1): ‘Logarithmic Scale Trimming’ UI.</span><a class="headerlink" href="#id11" title="Permalink to this image">¶</a></p>
</div>
<p><a class="reference internal" href="#sangeralignment-shinyapp-10"><span class="std std-ref">Figure 12</span></a> shows another quality trimming methods for users to choose from, Trimming Method 2 (M2): ‘Logarithmic Scale Sliding Window Trimming’. Users can change the cutoff quality score as well as sliding window size and click “Apply Trimming Parameters button” to update the UI. The value of cutoff quality score must be between 0 and 60 (default 20); the value of sliding window size must be between 0 and 40 (default 10). If the inputs are invalid, their values will be set to default.</p>
<div class="figure align-center" id="id12">
<span id="sangeralignment-shinyapp-10"></span><a class="reference internal image-reference" href="../_images/SangerAlignment_ShinyApp_10.png"><img alt="../_images/SangerAlignment_ShinyApp_10.png" src="../_images/SangerAlignment_ShinyApp_10.png" style="width: 722.7px; height: 279.90000000000003px;" /></a>
<p class="caption"><span class="caption-text">Figure 12. <em>SangerRead</em> page - Trimming Method 2 (M2): ‘Logarithmic Scale Sliding Window Trimming’ UI.</span><a class="headerlink" href="#id12" title="Permalink to this image">¶</a></p>
</div>
<p><a class="reference internal" href="#sangeralignment-shinyapp-11"><span class="std std-ref">Figure 13</span></a> shows the quality report before trimming and after trimming. After clicking the “Apply Trimming Parameters” button, the values of these information boxes will be updated to the latest values.</p>
<div class="figure align-center" id="id13">
<span id="sangeralignment-shinyapp-11"></span><a class="reference internal image-reference" href="../_images/SangerAlignment_ShinyApp_11.png"><img alt="../_images/SangerAlignment_ShinyApp_11.png" src="../_images/SangerAlignment_ShinyApp_11.png" style="width: 698.85px; height: 331.2px;" /></a>
<p class="caption"><span class="caption-text">Figure 13. <em>SangerRead</em> page - read quality report before / after trimming.</span><a class="headerlink" href="#id13" title="Permalink to this image">¶</a></p>
</div>
<p>In <a class="reference internal" href="#sangeralignment-shinyapp-13"><span class="std std-ref">Figure 14</span></a>, the x-axis is the index of the base pairs; the y-axis is the Phred quality score. The green horizontal bar at the top is the raw read region and the orange horizontal bar represents the trimmed read region. Both <a class="reference internal" href="#sangeralignment-shinyapp-13"><span class="std std-ref">Figure 14</span></a> and <a class="reference internal" href="#sangeralignment-shinyapp-14"><span class="std std-ref">Figure 15</span></a> will be updated once users change the input parameters and click the “Apply Trimming Parameters&quot; button.</p>
<div class="figure align-center" id="id14">
<span id="sangeralignment-shinyapp-13"></span><a class="reference internal image-reference" href="../_images/SangerAlignment_ShinyApp_13.png"><img alt="../_images/SangerAlignment_ShinyApp_13.png" src="../_images/SangerAlignment_ShinyApp_13.png" style="width: 722.5px; height: 362.5px;" /></a>
<p class="caption"><span class="caption-text">Figure 14. <em>SangerRead</em> page - quality score for each base pairs.</span><a class="headerlink" href="#id14" title="Permalink to this image">¶</a></p>
</div>
<p>If we only see primary and secondary sequences in the table, we will loose some variations. Chromatogram is very helpful to check the peak resolution. <a class="reference internal" href="#sangeralignment-shinyapp-14"><span class="std std-ref">Figure 15</span></a> shows the panel of plotting chromatogram. Users can change four parameters: “Base Number Per Row”, “Height Per Row”, “Signal Ratio Cutoff”, and “Show Trimmed Region”. Among them, “Signal Ratio Cutoff” is a key parameter. If its value is default value 0.33, it indicates that the lower peak should be at least 1/3rd as high as the higher peak for it count as a secondary peak.</p>
<div class="figure align-center" id="id15">
<span id="sangeralignment-shinyapp-14"></span><a class="reference internal image-reference" href="../_images/SangerAlignment_ShinyApp_14.png"><img alt="../_images/SangerAlignment_ShinyApp_14.png" src="../_images/SangerAlignment_ShinyApp_14.png" style="width: 722.25px; height: 420.3px;" /></a>
<p class="caption"><span class="caption-text">Figure 15. <em>SangerRead</em> page - chromatogram panel.</span><a class="headerlink" href="#id15" title="Permalink to this image">¶</a></p>
</div>
<p>Here is an example of applying new chromatogram parameters. We click “Show Trimmed Region” to set its value from FALSE to TRUE. <a class="reference internal" href="#sangeralignment-shinyapp-15"><span class="std std-ref">Figure 16</span></a> shows the loading notification popup during base calling and chromatogram plotting.</p>
<div class="figure align-center" id="id16">
<span id="sangeralignment-shinyapp-15"></span><a class="reference internal image-reference" href="../_images/SangerAlignment_ShinyApp_15.png"><img alt="../_images/SangerAlignment_ShinyApp_15.png" src="../_images/SangerAlignment_ShinyApp_15.png" style="width: 725.4px; height: 423.90000000000003px;" /></a>
<p class="caption"><span class="caption-text">Figure 16. Loading notification popup during replotting chromatogram.</span><a class="headerlink" href="#id16" title="Permalink to this image">¶</a></p>
</div>
<p>After replotting the chromatogram, trimmed region is showed in red striped region. <a class="reference internal" href="#sangeralignment-shinyapp-16"><span class="std std-ref">Figure 17</span></a> shows part of the the chromatogram (1 bp ~ 240 bp). Moreover, chromatogram will be replotted when trimmed positions or chromatogram parameters are updated.</p>
<div class="figure align-center" id="id17">
<span id="sangeralignment-shinyapp-16"></span><a class="reference internal image-reference" href="../_images/SangerAlignment_ShinyApp_16.png"><img alt="../_images/SangerAlignment_ShinyApp_16.png" src="../_images/SangerAlignment_ShinyApp_16.png" style="width: 772.0px; height: 416.5px;" /></a>
<p class="caption"><span class="caption-text">Figure 17. Chromatogram with showing trimmed region.</span><a class="headerlink" href="#id17" title="Permalink to this image">¶</a></p>
</div>
<p>To let user browse the trimmed primary/secondary sequences without finding “Trimming start point” and “Trimming End point” in <a class="reference internal" href="#sangeralignment-shinyapp-17"><span class="std std-ref">Figure 18</span></a> by themselves, we provide the final trimmed primary/secondary sequences that will be used for consensus read alignment in table format with quality scores in Figure 19.</p>
<div class="figure align-center" id="id18">
<span id="sangeralignment-shinyapp-17"></span><a class="reference internal image-reference" href="../_images/SangerAlignment_ShinyApp_17.png"><img alt="../_images/SangerAlignment_ShinyApp_17.png" src="../_images/SangerAlignment_ShinyApp_17.png" style="width: 723.15px; height: 300.6px;" /></a>
<p class="caption"><span class="caption-text">Figure 18. Trimmed primary/secondary sequences and Phred quality score in Table format.</span><a class="headerlink" href="#id18" title="Permalink to this image">¶</a></p>
</div>
<p>We have updated the trimming and chromatogram parameters for each read. Now, we need to click “Re-calculate consensus read button” to do alignment again. Last but not least, we can save all data into a new ‘SangerContig’ S4 instance by clicking “Save S4 Object button”. New S4 instance would be saved in Rda format. Users can run readRDS function to load it into current R environment. <a class="reference internal" href="#sangeralignment-shinyapp-18"><span class="std std-ref">Figure 19</span></a> shows some hints in the save notification popup.</p>
<div class="figure align-center" id="id19">
<span id="sangeralignment-shinyapp-18"></span><a class="reference internal image-reference" href="../_images/SangerAlignment_ShinyApp_18.png"><img alt="../_images/SangerAlignment_ShinyApp_18.png" src="../_images/SangerAlignment_ShinyApp_18.png" style="width: 767.6px; height: 386.8px;" /></a>
<p class="caption"><span class="caption-text">Figure 19. Save notification popup.</span><a class="headerlink" href="#id19" title="Permalink to this image">¶</a></p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
</div>
<div class="section" id="writing-fasta-files">
<h2>Writing FASTA files<a class="headerlink" href="#writing-fasta-files" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="generating-sangeralignment-report">
<h2>Generating <em>SangerAlignment</em> report<a class="headerlink" href="#generating-sangeralignment-report" title="Permalink to this headline">¶</a></h2>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="conclusion.html" class="btn btn-neutral float-right" title="Conclusion" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="advance_user_SangerContig.html" class="btn btn-neutral float-left" title="Advanced User Guide - SangerContig" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Kuan-Hao Chao

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>