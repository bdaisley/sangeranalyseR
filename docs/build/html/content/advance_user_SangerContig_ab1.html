

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Advanced User Guide - SangerContig (AB1) &mdash; sangeranalyseR  documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="sangeranalyseR  documentation" href="../index.html"/>
        <link rel="next" title="Advanced User Guide - SangerAlignment (AB1)" href="advance_user_SangerAlignment_ab1.html"/>
        <link rel="prev" title="Advanced User Guide - SangerRead (AB1)" href="advance_user_SangerRead_ab1.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> sangeranalyseR
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quick Start Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="beginner.html">Beginners Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="advance_user_SangerRead_ab1.html">Advanced User Guide - <em>SangerRead</em> (<strong>AB1</strong>)</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Advanced User Guide - <em>SangerContig</em> (<strong>AB1</strong>)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#preparing-sangercontig-ab1-input">Preparing <em>SangerContig</em> <strong>AB1</strong> input</a></li>
<li class="toctree-l2"><a class="reference internal" href="#creating-sangercontig-instance-from-ab1">Creating <em>SangerContig</em> instance from <strong>AB1</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="#updating-sangercontig-quality-trimming-parameters">Updating <em>SangerContig</em> quality trimming parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="#launching-sangercontig-shiny-app">Launching <em>SangerContig</em> Shiny app</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#sangercontig-page-sc-app"><em>SangerContig</em> page (SC app)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sangerread-page-sc-app"><em>SangerRead</em> page (SC app)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#writing-sangercontig-fasta-files-ab1">Writing <em>SangerContig</em> FASTA files <sub>(AB1)</sub></a></li>
<li class="toctree-l2"><a class="reference internal" href="#generating-sangercontig-report-ab1">Generating <em>SangerContig</em> report <sub>(AB1)</sub></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="advance_user_SangerAlignment_ab1.html">Advanced User Guide - <em>SangerAlignment</em> (<strong>AB1</strong>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="advance_user_SangerRead_fasta.html">Advanced User Guide - <em>SangerRead</em> (<strong>FASTA</strong>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="advance_user_SangerContig_fasta.html">Advanced User Guide - <em>SangerContig</em> (<strong>FASTA</strong>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="advance_user_SangerAlignment_fasta.html">Advanced User Guide - <em>SangerAlignment</em> (<strong>FASTA</strong>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="conclusion.html">Conclusion</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="contact.html">Contact</a></li>
<li class="toctree-l1"><a class="reference internal" href="help.html">Help</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">sangeranalyseR</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
    <li>Advanced User Guide - <em>SangerContig</em> (<strong>AB1</strong>)</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/content/advance_user_SangerContig_ab1.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="advanced-user-guide-sangercontig-ab1">
<h1>Advanced User Guide - <em>SangerContig</em> (<strong>AB1</strong>)<a class="headerlink" href="#advanced-user-guide-sangercontig-ab1" title="Permalink to this headline">¶</a></h1>
<p><em>SangerContig</em> is the second level in sangeranalyseR showed in <a class="reference internal" href="#sangercontig-hierarchy"><span class="std std-ref">Figure_1</span></a> which corresponds to a contig in Sanger sequencing. Among slots inside it, there are two lists, forward and reverse read list, storing <em>SangerRead</em> in the corresponding direction. In this section, we are going to go through details about sangeranalyseR data analysis in <em>SangerContig</em> level from <strong>AB1</strong> file input.</p>
<div class="figure align-center" id="id3">
<span id="sangercontig-hierarchy"></span><a class="reference internal image-reference" href="../_images/SangerContig_hierarchy.png"><img alt="../_images/SangerContig_hierarchy.png" src="../_images/SangerContig_hierarchy.png" style="width: 586.6px; height: 217.8px;" /></a>
<p class="caption"><span class="caption-text">Figure 1. Hierarchy of classes in sangeranalyseR, <em>SangerContig</em> level.</span></p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="section" id="preparing-sangercontig-ab1-input">
<h2>Preparing <em>SangerContig</em> <strong>AB1</strong> input<a class="headerlink" href="#preparing-sangercontig-ab1-input" title="Permalink to this headline">¶</a></h2>
<p>The main input file format to create <em>SangerRead</em> instance is <strong>AB1</strong>. Before starting the analysis, users need to prepare all <strong>AB1</strong> files inside one directory. It is the parent directory and all <strong>AB1</strong> files must be in the first layer of it; in other words, there should not be any directory containing any <strong>AB1</strong> files inside the parent directory. Because sangeranalyseR will group <strong>AB1</strong> files based on their direction automatically, users have to follow the file naming regulations below:</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>All the input files must have <strong>.ab1</strong> as its file extension</li>
<li>All the input files must have the same contig name in its filename.</li>
<li>Forward or reverse direction also has to be specified in the filename.</li>
</ul>
</div>
<p>There are four parameters, <code class="code docutils literal"><span class="pre">parentDirectory</span></code>, <code class="code docutils literal"><span class="pre">contigName</span></code>, <code class="code docutils literal"><span class="pre">suffixForwardRegExp</span></code> and <code class="code docutils literal"><span class="pre">suffixReverseRegExp</span></code>,that users need to provide so that program can automatically match correct <strong>AB1</strong> files and divide them into forward and reverse direction.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li><code class="code docutils literal"><span class="pre">parentDirectory</span></code>: The root directory that contains all the <strong>AB1</strong> files. It can be absolute or relative path. We suggest users to put only target <strong>AB1</strong> files inside this directory without other unrelated files.</li>
<li><code class="code docutils literal"><span class="pre">contigName</span></code>: The value of this parameter is a regular expression that matches filenames that are going to be included in the <em>SangerContig</em> level analysis. <code class="code docutils literal"><span class="pre">grepl</span></code> function in R is used.</li>
<li><code class="code docutils literal"><span class="pre">suffixForwardRegExp</span></code>: The value of this parameter is a regular expression that matches all filenames in forward direction. <code class="code docutils literal"><span class="pre">grepl</span></code> function in R is used to select forward reads from all <strong>AB1</strong> files.</li>
<li><code class="code docutils literal"><span class="pre">suffixReverseRegExp</span></code>: The value of this parameter is a regular expression that matches all filenames in reverse direction. <code class="code docutils literal"><span class="pre">grepl</span></code> function in R is used to select reverse reads from all <strong>AB1</strong> files.</li>
</ul>
</div>
<p>Here, we have an example:</p>
<div class="figure align-center" id="id4">
<span id="sangercontig-file-structure"></span><a class="reference internal image-reference" href="../_images/SangerContig_file_structure.png"><img alt="../_images/SangerContig_file_structure.png" src="../_images/SangerContig_file_structure.png" style="width: 324.0px; height: 374.4px;" /></a>
<p class="caption"><span class="caption-text">Figure 2. <em>SangerContig</em> filename regulation.</span></p>
</div>
<p><a class="reference internal" href="#sangercontig-file-structure"><span class="std std-ref">Figure_2</span></a> shows the file naming regulation and hierarchy. In this example, <code class="code docutils literal"><span class="pre">ACHLO</span></code> is the parent directory that contains all <strong>AB1</strong> files. They must be in the first layer of the directory.</p>
<p>sangeranalyseR will first match the <code class="code docutils literal"><span class="pre">contigName</span></code> to exclude unrelated files and then separate the forward and reverse reads by matching <code class="code docutils literal"><span class="pre">suffixForwardRegExp</span></code> and <code class="code docutils literal"><span class="pre">suffixReverseRegExp</span></code>. Therefore, it is important to make sure all target <strong>AB1</strong> files share the same <code class="code docutils literal"><span class="pre">contigName</span></code> and carefully select <code class="code docutils literal"><span class="pre">suffixForwardRegExp</span></code> and <code class="code docutils literal"><span class="pre">suffixReverseRegExp</span></code>. The bad file naming and wrong regex matching might accidentally include reverse reads into the forward read list or vice versa, which will make the program generate totally wrong results. Therefore, users should have a consistent naming strategy. In this example, <code class="code docutils literal"><span class="pre">&quot;_[0-9]+_F&quot;</span></code>, <code class="code docutils literal"><span class="pre">&quot;_[0-9]+_R&quot;</span></code> for matching forward and reverse reads are highly suggested and are used as default. Moreover, it is a good habit to index your reads in the same contig group because there might be more than one read that are in the forward or reverse direction.</p>
<div class="figure align-center" id="id5">
<span id="sangeranalyser-filename-convention-sangercontig"></span><a class="reference internal image-reference" href="../_images/sangeranalyseR_filename_convention.png"><img alt="../_images/sangeranalyseR_filename_convention.png" src="../_images/sangeranalyseR_filename_convention.png" style="width: 621.0px; height: 28.0px;" /></a>
<p class="caption"><span class="caption-text">Figure 3. Suggested <strong>AB1</strong> file naming regulation - <em>SangerContig</em>.</span></p>
</div>
<p><a class="reference internal" href="#sangeranalyser-filename-convention-sangercontig"><span class="std std-ref">Figure_3</span></a> shows the suggested <strong>AB1</strong> file naming regulation. Users are strongly recommended to follow this file naming regulation and use the default <code class="code docutils literal"><span class="pre">suffixForwardRegExp</span></code> : &#8220;<code class="code docutils literal"><span class="pre">_[0-9]+_F</span></code>&#8221; and <code class="code docutils literal"><span class="pre">suffixReverseRegExp</span></code> : &#8220;<code class="code docutils literal"><span class="pre">_[0-9]+_R</span></code>&#8221; to reduce any chance of error.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="creating-sangercontig-instance-from-ab1">
<h2>Creating <em>SangerContig</em> instance from <strong>AB1</strong><a class="headerlink" href="#creating-sangercontig-instance-from-ab1" title="Permalink to this headline">¶</a></h2>
<p>After preparing the input directory, we can create the <em>SangerContig</em> S4 instance by running <code class="code docutils literal"><span class="pre">SangerContig</span></code> constructor function or <code class="code docutils literal"><span class="pre">new</span></code> method. The constructor function is a wrapper for <code class="code docutils literal"><span class="pre">new</span></code> method and it makes instance creation more intuitive. Most parameters in the constructor have their own default values. In the constructor below, we list important parameters.</p>
<div class="highlight-R"><div class="highlight"><pre><span></span>sangerContig <span class="o">&lt;-</span> SangerContig<span class="p">(</span>inputSource            <span class="o">=</span> <span class="s">&quot;ABIF&quot;</span><span class="p">,</span>
                             parentDirectory        <span class="o">=</span> <span class="s">&quot;./tmp/&quot;</span><span class="p">,</span>
                             contigName             <span class="o">=</span> <span class="s">&quot;Achl_ACHLO006-09&quot;</span><span class="p">,</span>
                             suffixForwardRegExp    <span class="o">=</span> <span class="s">&quot;[0-9]*_F.ab1&quot;</span><span class="p">,</span>
                             suffixReverseRegExp    <span class="o">=</span> <span class="s">&quot;[0-9]*_R.ab1&quot;</span><span class="p">,</span>
                             TrimmingMethod         <span class="o">=</span> <span class="s">&quot;M1&quot;</span><span class="p">,</span>
                             M1TrimmingCutoff       <span class="o">=</span> <span class="m">0.0001</span><span class="p">,</span>
                             M2CutoffQualityScore   <span class="o">=</span> <span class="kc">NULL</span><span class="p">,</span>
                             M2SlidingWindowSize    <span class="o">=</span> <span class="kc">NULL</span><span class="p">,</span>
                             baseNumPerRow          <span class="o">=</span> <span class="m">100</span><span class="p">,</span>
                             heightPerRow           <span class="o">=</span> <span class="m">200</span><span class="p">,</span>
                             signalRatioCutoff      <span class="o">=</span> <span class="m">0.33</span><span class="p">,</span>
                             showTrimmed            <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span>
                             refAminoAcidSeq        <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">,</span>
                             minReadsNum            <span class="o">=</span> <span class="m">2</span><span class="p">,</span>
                             minReadLength          <span class="o">=</span> <span class="m">20</span><span class="p">,</span>
                             minFractionCall        <span class="o">=</span> <span class="m">0.5</span><span class="p">,</span>
                             maxFractionLost        <span class="o">=</span> <span class="m">0.5</span><span class="p">,</span>
                             geneticCode            <span class="o">=</span> GENETIC_CODE<span class="p">,</span>
                             acceptStopCodons       <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span>
                             readingFrame           <span class="o">=</span> <span class="m">1</span><span class="p">,</span>
                             processorsNum          <span class="o">=</span> <span class="kc">NULL</span><span class="p">)</span>
</pre></div>
</div>
<p>In this example, <code class="code docutils literal"><span class="pre">contigName</span></code> is set to <code class="code docutils literal"><span class="pre">&quot;Achl_ACHLO006-09&quot;</span></code>, so only <code class="code docutils literal"><span class="pre">&quot;Achl_ACHLO006-09_1_F.ab1&quot;</span></code> and <code class="code docutils literal"><span class="pre">&quot;Achl_ACHLO006-09_2_R.ab1&quot;</span></code> will be selected to align to a contig.</p>
<p>The inputs of <code class="code docutils literal"><span class="pre">SangerContig</span></code> constructor function and <code class="code docutils literal"><span class="pre">new</span></code> method are same. For more details about <em>SangerContig</em> inputs and slots definition, please refer to <a class="reference external" href="http://packages.python.org/an_example_pypi_project/">sangeranalyseR reference manual (need update)</a>. The created <em>SangerContig</em> instance, <code class="code docutils literal"><span class="pre">sangerContig</span></code>, is used as the input for the following functions.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="updating-sangercontig-quality-trimming-parameters">
<h2>Updating <em>SangerContig</em> quality trimming parameters<a class="headerlink" href="#updating-sangercontig-quality-trimming-parameters" title="Permalink to this headline">¶</a></h2>
<p>In the previous <span class="xref std std-ref">Creating *SangerContig* instance from **AB1**</span> part, the constructor function will apply the quality trimming parameters to all reads. After creating the SangerContig S4 instance, users can change the trimming parameters by running <code class="code docutils literal"><span class="pre">updateQualityParam</span></code> function which will update all reads with the new trimming parameters and redo reads alignment. If users want to do quality trimming read by read instead of all at once, please read <span class="xref std std-ref">Launching *SangerContig* Shiny app</span> page.</p>
<div class="highlight-R"><div class="highlight"><pre><span></span>newSangerContig <span class="o">&lt;-</span> updateQualityParam<span class="p">(</span>sangerContig<span class="p">,</span>
                                      TrimmingMethod       <span class="o">=</span> <span class="s">&quot;M2&quot;</span><span class="p">,</span>
                                      M1TrimmingCutoff     <span class="o">=</span> <span class="kc">NULL</span><span class="p">,</span>
                                      M2CutoffQualityScore <span class="o">=</span> <span class="m">20</span><span class="p">,</span>
                                      M2SlidingWindowSize  <span class="o">=</span> <span class="m">15</span><span class="p">)</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="launching-sangercontig-shiny-app">
<h2>Launching <em>SangerContig</em> Shiny app<a class="headerlink" href="#launching-sangercontig-shiny-app" title="Permalink to this headline">¶</a></h2>
<p>We create an interactive local Shiny app for users to go into each <em>SangerRead</em> in <em>SangerContig</em> instance. Users only need to run one function, <code class="code docutils literal"><span class="pre">launchApp</span></code>, with previously created instance as input and the <em>SangerContig</em> Shiny app will pop up. Here, we will go through pages in the two levels, <em>SangerRead</em> and <em>SangerContig</em> pages.</p>
<div class="highlight-R"><div class="highlight"><pre><span></span>launchApp<span class="p">(</span>newSangerContig<span class="p">)</span>
</pre></div>
</div>
<div class="section" id="sangercontig-page-sc-app">
<h3><em>SangerContig</em> page (SC app)<a class="headerlink" href="#sangercontig-page-sc-app" title="Permalink to this headline">¶</a></h3>
<p><em>SangerContig</em> page is the initial page of <em>SangerContig</em> Shiny app. <a class="reference internal" href="#sangercontig-shiny-sangercontig-page"><span class="std std-ref">Figure 4</span></a> shows the overview page of the contig. Notice that there is a red &#8220;Re-calculate Contig&#8221; button. Users need to click the button after changing the quality trimming parameters in order to get the updated information. In SangerContig page, there are two expendable tabs, “Forward Reads” and “Reverse Reads” storing the corresponding reads on the left-hand side navigation panel in <a class="reference internal" href="#sangercontig-shiny-sangercontig-page"><span class="std std-ref">Figure 4</span></a>. See <span class="xref std std-ref">*SangerRead* page (SC app)</span> for more details of the subpage.</p>
<div class="figure align-center" id="id6">
<span id="sangercontig-shiny-sangercontig-page"></span><a class="reference internal image-reference" href="../_images/SangerContig_shiny_SangerContig_page.png"><img alt="../_images/SangerContig_shiny_SangerContig_page.png" src="../_images/SangerContig_shiny_SangerContig_page.png" style="width: 576.0px; height: 318.0px;" /></a>
<p class="caption"><span class="caption-text">Figure 4. <em>SangerContig</em> Shiny app initial page - <em>SangerContig</em> page.</span></p>
</div>
<p>The information provided in this page are input parameters and contig results including “genetic code table”, “reference amino acid sequence”, “reads alignment”, “difference data frame”, “dendrogram”, “sample distance heatmap”, “indels data frame”, and “stop codons data frame”.</p>
<p><a class="reference internal" href="#sangercontig-shiny-alignment-differencedf"><span class="std std-ref">Figure 5</span></a> shows reads alignment result and difference data frame. The alignment is generated by <code class="code docutils literal"><span class="pre">AlignSeqs</span></code> or <code class="code docutils literal"><span class="pre">AlignTranslation</span></code> function in <a class="reference external" href="https://bioconductor.org/packages/release/bioc/html/DECIPHER.html">DECIPHER</a> package.</p>
<div class="figure align-center" id="id7">
<span id="sangercontig-shiny-alignment-differencedf"></span><a class="reference internal image-reference" href="../_images/SangerContig_shiny_alignment_differenceDF.png"><img alt="../_images/SangerContig_shiny_alignment_differenceDF.png" src="../_images/SangerContig_shiny_alignment_differenceDF.png" style="width: 660.0px; height: 361.2px;" /></a>
<p class="caption"><span class="caption-text">Figure 5. <em>SangerContig</em> page - reads alignment and difference data frame.</span></p>
</div>
<p><a class="reference internal" href="#sangercontig-shiny-dendrogram"><span class="std std-ref">Figure 6</span></a> shows dendrogram result in both plot and in data frame. The results are generated by <code class="code docutils literal"><span class="pre">IdClusters</span></code> function in <a class="reference external" href="https://bioconductor.org/packages/release/bioc/html/DECIPHER.html">DECIPHER</a> package.</p>
<div class="figure align-center" id="id8">
<span id="sangercontig-shiny-dendrogram"></span><a class="reference internal image-reference" href="../_images/SangerContig_shiny_dendrogram.png"><img alt="../_images/SangerContig_shiny_dendrogram.png" src="../_images/SangerContig_shiny_dendrogram.png" style="width: 660.0px; height: 456.6px;" /></a>
<p class="caption"><span class="caption-text">Figure 6. <em>SangerContig</em> page - dendrogram.</span></p>
</div>
<p><a class="reference internal" href="#sangercontig-shiny-samples-distance"><span class="std std-ref">Figure 7</span></a> shows distance between <strong>AB1</strong> files. The results are generated by <code class="code docutils literal"><span class="pre">DistanceMatrix</span></code> function in <a class="reference external" href="https://bioconductor.org/packages/release/bioc/html/DECIPHER.html">DECIPHER</a> package. The heatmap is generated by <code class="code docutils literal"><span class="pre">plot_ly</span></code> function in <a class="reference external" href="https://plot.ly/r/">plotly</a> package.</p>
<div class="figure align-center" id="id9">
<span id="sangercontig-shiny-samples-distance"></span><a class="reference internal image-reference" href="../_images/SangerContig_shiny_samples_distance.png"><img alt="../_images/SangerContig_shiny_samples_distance.png" src="../_images/SangerContig_shiny_samples_distance.png" style="width: 658.8px; height: 455.4px;" /></a>
<p class="caption"><span class="caption-text">Figure 7. <em>SangerContig</em> page - samples distance.</span></p>
</div>
<p><a class="reference internal" href="#sangercontig-shiny-indelsdf-stopcodonsdf"><span class="std std-ref">Figure 8</span></a> shows insertions, deletions and stop codons data frame.</p>
<div class="figure align-center" id="id10">
<span id="sangercontig-shiny-indelsdf-stopcodonsdf"></span><a class="reference internal image-reference" href="../_images/SangerContig_shiny_indelsDF_stopcodonsDF.png"><img alt="../_images/SangerContig_shiny_indelsDF_stopcodonsDF.png" src="../_images/SangerContig_shiny_indelsDF_stopcodonsDF.png" style="width: 631.2px; height: 436.2px;" /></a>
<p class="caption"><span class="caption-text">Figure 8. <em>SangerContig</em> page - indels and stop codons data frame.</span></p>
</div>
</div>
<div class="section" id="sangerread-page-sc-app">
<h3><em>SangerRead</em> page (SC app)<a class="headerlink" href="#sangerread-page-sc-app" title="Permalink to this headline">¶</a></h3>
<p>Now, let&#8217;s go to the next level which is also the lowest level, <em>SangerRead</em> page. <em>SangerRead</em> page contains all details of a read including its trimming and chromatogram inputs and results. All reads are in &#8220;forward&#8221; or &#8220;reverse&#8221; direction. In this example, there is one read in each direction and <a class="reference internal" href="#sangercontig-shiny-sangerread-page"><span class="std std-ref">Figure 9</span></a> shows &#8220;1 Forward Read&#8221; page. This page provides basic information, quality trimming inputs, chromatogram plotting inputs etc. Primary/secondary sequences and quality Phred scores table in this figure are dynamic based on the <code class="code docutils literal"><span class="pre">signalRatioCutoff</span></code> value for base calling and the length of them are always same. Another thing to mention is that primary/secondary sequences and the sequences in the chromatogram in <a class="reference internal" href="#sangercontig-shiny-chromatogram-panel"><span class="std std-ref">Figure 14</span></a> below will always be same after trimming and their color codings for A/T/C/G are same as well.</p>
<div class="figure align-center" id="id11">
<span id="sangercontig-shiny-sangerread-page"></span><a class="reference internal image-reference" href="../_images/SangerContig_shiny_SangerRead_page.png"><img alt="../_images/SangerContig_shiny_SangerRead_page.png" src="../_images/SangerContig_shiny_SangerRead_page.png" style="width: 576.0px; height: 327.2px;" /></a>
<p class="caption"><span class="caption-text">Figure 9. <em>SangerContig</em> Shiny app - <em>SangerRead</em> page</span></p>
</div>
<p>In quality trimming steps, we removes fragment at both ends of sequencing reads with low quality score. It is important because trimmed reads will improves alignment results. <a class="reference internal" href="#sangercontig-shiny-trimming-1"><span class="std std-ref">Figure 10</span></a> shows the UI for Trimming Method 1 (M1): ‘Modified Mott Trimming’. This method is implemented in <a class="reference external" href="http://www.phrap.org/phredphrapconsed.html">Phred</a>. Users can change the cutoff score and click “Apply Trimming Parameters&#8221; button to update the UI. The value of input must be between 0 and 1. If the input is invalid, the cutoff score will be set to default 0.0001.</p>
<div class="figure align-center" id="id12">
<span id="sangercontig-shiny-trimming-1"></span><a class="reference internal image-reference" href="../_images/SangerContig_shiny_trimming_1.png"><img alt="../_images/SangerContig_shiny_trimming_1.png" src="../_images/SangerContig_shiny_trimming_1.png" style="width: 693.0px; height: 324.0px;" /></a>
<p class="caption"><span class="caption-text">Figure 10. <em>SangerRead</em> page - Trimming Method 1 (M1): ‘Modified Mott Trimming’ UI.</span></p>
</div>
<p><a class="reference internal" href="#sangercontig-shiny-trimming-2"><span class="std std-ref">Figure 11</span></a> shows another quality trimming method for users to choose from, Trimming Method 2 (M2): ‘Trimmomatics Sliding Window Trimming’. This method is implemented in <a class="reference external" href="http://www.usadellab.org/cms/?page=trimmomatic">Trimmomatics</a>. Users can change the cutoff quality score as well as sliding window size and click “Apply Trimming Parameters&#8221; button to update the UI. The value of cutoff quality score must be between 0 and 60 (default 20); the value of sliding window size must be between 0 and 40 (default 10). If the inputs are invalid, their values will be set to default.</p>
<div class="figure align-center" id="id13">
<span id="sangercontig-shiny-trimming-2"></span><a class="reference internal image-reference" href="../_images/SangerContig_shiny_trimming_2.png"><img alt="../_images/SangerContig_shiny_trimming_2.png" src="../_images/SangerContig_shiny_trimming_2.png" style="width: 693.6px; height: 323.4px;" /></a>
<p class="caption"><span class="caption-text">Figure 11. <em>SangerRead</em> page - Trimming Method 2 (M2): ‘Trimmomatics Sliding Window Trimming’ UI.</span></p>
</div>
<p><a class="reference internal" href="#sangercontig-shiny-trimmed-before-after"><span class="std std-ref">Figure 12</span></a> shows the quality report before and after trimming. After clicking the “Apply Trimming Parameters” button in <a class="reference internal" href="#sangercontig-shiny-trimming-1"><span class="std std-ref">Figure 10</span></a> or <a class="reference internal" href="#sangercontig-shiny-trimming-2"><span class="std std-ref">Figure 11</span></a>, the values of these information boxes will be updated to the latest values.</p>
<div class="figure align-center" id="id14">
<span id="sangercontig-shiny-trimmed-before-after"></span><a class="reference internal image-reference" href="../_images/SangerContig_shiny_trimmed_before_after.png"><img alt="../_images/SangerContig_shiny_trimmed_before_after.png" src="../_images/SangerContig_shiny_trimmed_before_after.png" style="width: 660.6px; height: 384.0px;" /></a>
<p class="caption"><span class="caption-text">Figure 12. <em>SangerRead</em> page - read quality report before / after trimming.</span></p>
</div>
<p>In <a class="reference internal" href="#sangercontig-shiny-bp-quality-plot"><span class="std std-ref">Figure 13</span></a>, the x-axis is the index of the base pairs; the y-axis is the Phred quality score. The green horizontal bar at the top of the plot is the raw read region and the orange horizontal bar represents the remaining read region. Both <a class="reference internal" href="#sangercontig-shiny-bp-quality-plot"><span class="std std-ref">Figure 13</span></a> trimming plot and <a class="reference internal" href="#sangercontig-shiny-chromatogram-panel"><span class="std std-ref">Figure 14</span></a> chromatogram will be updated once users change the quality trimming parameters and click the “Apply Trimming Parameters&#8221; button in <a class="reference internal" href="#sangercontig-shiny-chromatogram-panel"><span class="std std-ref">Figure 14</span></a>.</p>
<div class="figure align-center" id="id15">
<span id="sangercontig-shiny-bp-quality-plot"></span><a class="reference internal image-reference" href="../_images/SangerContig_shiny_bp_quality_plot.png"><img alt="../_images/SangerContig_shiny_bp_quality_plot.png" src="../_images/SangerContig_shiny_bp_quality_plot.png" style="width: 646.2px; height: 312.0px;" /></a>
<p class="caption"><span class="caption-text">Figure 13. <em>SangerContig</em> page - quality trimming plot.</span></p>
</div>
<p>If we only see primary and secondary sequences in the table, we will loose some variations. Chromatogram is very helpful to check the peak resolution. <a class="reference internal" href="#sangercontig-shiny-chromatogram-panel"><span class="std std-ref">Figure 14</span></a> shows the panel of plotting chromatogram. Users can change four parameters: <code class="code docutils literal"><span class="pre">Base</span> <span class="pre">Number</span> <span class="pre">Per</span> <span class="pre">Row</span></code>, <code class="code docutils literal"><span class="pre">Height</span> <span class="pre">Per</span> <span class="pre">Row</span></code>, <code class="code docutils literal"><span class="pre">Signal</span> <span class="pre">Ratio</span> <span class="pre">Cutoff</span></code>, and <code class="code docutils literal"><span class="pre">Show</span> <span class="pre">Trimmed</span> <span class="pre">Region</span></code>. Among them, <code class="code docutils literal"><span class="pre">Signal</span> <span class="pre">Ratio</span> <span class="pre">Cutoff</span></code> is a key parameter. If its value is default value 0.33, it indicates that the lower peak should be at least 1/3rd as high as the higher peak for it count as a secondary peak.</p>
<div class="figure align-center" id="id16">
<span id="sangercontig-shiny-chromatogram-panel"></span><a class="reference internal image-reference" href="../_images/SangerContig_shiny_chromatogram_panel.png"><img alt="../_images/SangerContig_shiny_chromatogram_panel.png" src="../_images/SangerContig_shiny_chromatogram_panel.png" style="width: 693.6px; height: 488.4px;" /></a>
<p class="caption"><span class="caption-text">Figure 14. <em>SangerContig</em> page - chromatogram panel.</span></p>
</div>
<p>Here is an example of applying new chromatogram parameters. We click “Show Trimmed Region” to set its value from <code class="code docutils literal"><span class="pre">FALSE</span></code> to <code class="code docutils literal"><span class="pre">TRUE</span></code> and click the &#8220;Apply Chromatogram Parameters&#8221; button. <a class="reference internal" href="#sangercontig-plotting-popup"><span class="std std-ref">Figure 15</span></a> shows the loading notification popup during base calling and chromatogram plotting.</p>
<div class="figure align-center" id="id17">
<span id="sangercontig-plotting-popup"></span><a class="reference internal image-reference" href="../_images/SangerContig_plotting_popup.png"><img alt="../_images/SangerContig_plotting_popup.png" src="../_images/SangerContig_plotting_popup.png" style="width: 691.2px; height: 487.8px;" /></a>
<p class="caption"><span class="caption-text">Figure 15. <em>SangerContig</em> page - loading notification popup during replotting chromatogram.</span></p>
</div>
<p>After replotting the chromatogram, we can see that trimmed region is showed in red striped region. <a class="reference internal" href="#sangercontig-shiny-chromatogram"><span class="std std-ref">Figure 16</span></a> shows part of the the chromatogram (1 bp ~ 240 bp). Moreover, chromatogram will be replotted when trimmed positions or chromatogram parameters are updated.</p>
<div class="figure align-center" id="id18">
<span id="sangercontig-shiny-chromatogram"></span><a class="reference internal image-reference" href="../_images/SangerContig_shiny_chromatogram.png"><img alt="../_images/SangerContig_shiny_chromatogram.png" src="../_images/SangerContig_shiny_chromatogram.png" style="width: 660.0px; height: 427.8px;" /></a>
<p class="caption"><span class="caption-text">Figure 16. <em>SangerContig</em> page - chromatogram with trimmed region showed.</span></p>
</div>
<p>To let users browse the trimmed primary/secondary sequences without finding “Trimming Start Point” and “Trimming End Point” by themselves, we provide the final trimmed primary/secondary sequences that will be used for reads alignment with quality scores in table format in <a class="reference internal" href="#sangercontig-shiny-trimmed-sequences"><span class="std std-ref">Figure 17</span></a>. Frameshift amino acid sequences are also provided.</p>
<div class="figure align-center" id="id19">
<span id="sangercontig-shiny-trimmed-sequences"></span><a class="reference internal image-reference" href="../_images/SangerContig_shiny_trimmed_sequences.png"><img alt="../_images/SangerContig_shiny_trimmed_sequences.png" src="../_images/SangerContig_shiny_trimmed_sequences.png" style="width: 646.8px; height: 298.48px;" /></a>
<p class="caption"><span class="caption-text">Figure 17. <em>SangerContig</em> page - trimmed primary/secondary sequences and Phred quality score in table format.</span></p>
</div>
<p>We have updated the trimming and chromatogram parameters for each read. Now, we need to click “Re-calculate contig” button to do alignment again. Last but not least, we can save all data into a new ‘SangerContig’ S4 instance by clicking “Save S4 Instance button”. New S4 instance will be saved in <strong>Rda</strong> format. Users can run <code class="code docutils literal"><span class="pre">readRDS</span></code> function to load it into current R environment. <a class="reference internal" href="#sangercontig-shiny-save-popup"><span class="std std-ref">Figure 18</span></a> shows some hints in the save notification popup.</p>
<div class="figure align-center" id="id20">
<span id="sangercontig-shiny-save-popup"></span><a class="reference internal image-reference" href="../_images/SangerContig_shiny_save_popup.png"><img alt="../_images/SangerContig_shiny_save_popup.png" src="../_images/SangerContig_shiny_save_popup.png" style="width: 719.0px; height: 437.0px;" /></a>
<p class="caption"><span class="caption-text">Figure 18. <em>SangerContig</em> page - saving notification popup.</span></p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
</div>
<div class="section" id="writing-sangercontig-fasta-files-ab1">
<h2>Writing <em>SangerContig</em> FASTA files <sub>(AB1)</sub><a class="headerlink" href="#writing-sangercontig-fasta-files-ab1" title="Permalink to this headline">¶</a></h2>
<p>Users can write the <em>SangerContig</em> instance to <strong>FASTA</strong> files. There are four options for users to choose from in <code class="code docutils literal"><span class="pre">selection</span></code> parameter.</p>
<ul class="simple">
<li><code class="code docutils literal"><span class="pre">reads_unalignment</span></code>: Writing reads into a single <strong>FASTA</strong> file (only trimmed without alignment).</li>
<li><code class="code docutils literal"><span class="pre">reads_alignment</span></code>: Writing reads alignment and contig read to a single <strong>FASTA</strong> file.</li>
<li><code class="code docutils literal"><span class="pre">contig</span></code>: Writing the contig to a single <strong>FASTA</strong> file.</li>
<li><code class="code docutils literal"><span class="pre">all</span></code>: Writing reads, reads alignment, and the contig into three different files.</li>
</ul>
<p>Below is the one-line function that users need to run. This function mainly depends on <code class="code docutils literal"><span class="pre">writeXStringSet</span></code> function in <a class="reference external" href="https://bioconductor.org/packages/release/bioc/html/Biostrings.html">Biostrings</a> R package. Users can set the compression level through <code class="code docutils literal"><span class="pre">writeFasta</span></code> function.</p>
<div class="highlight-R"><div class="highlight"><pre><span></span>writeFasta<span class="p">(</span>newSangerContig<span class="p">,</span>
           outputDir         <span class="o">=</span> <span class="kp">tempdir</span><span class="p">(),</span>
           compress          <span class="o">=</span> <span class="kc">FALSE</span><span class="p">,</span>
           compression_level <span class="o">=</span> <span class="kc">NA</span><span class="p">,</span>
           selection         <span class="o">=</span> <span class="s">&quot;all&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Users can download the output FASTA file of this example through the following three links:</p>
<ul class="simple">
<li><a class="reference external" href="https://howardchao.github.io/sangeranalyseR_report/SangerContig/AB1/ACHLO006-09[LCO1490_t1,HCO2198_t1]_reads_unalignment.fa">reads_unalignment FASTA file</a></li>
<li><a class="reference external" href="https://howardchao.github.io/sangeranalyseR_report/SangerContig/AB1/ACHLO006-09[LCO1490_t1,HCO2198_t1]_reads_alignment.fa">reads_alignment FASTA file</a></li>
<li><a class="reference external" href="https://howardchao.github.io/sangeranalyseR_report/SangerContig/AB1/ACHLO006-09[LCO1490_t1,HCO2198_t1]_contig.fa">contig FASTA file</a></li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="generating-sangercontig-report-ab1">
<h2>Generating <em>SangerContig</em> report <sub>(AB1)</sub><a class="headerlink" href="#generating-sangercontig-report-ab1" title="Permalink to this headline">¶</a></h2>
<p>Last but not least, users can save <em>SangerContig</em> instance into a report after the analysis. The report will be generated in <strong>HTML</strong> by knitting <strong>Rmd</strong> files.</p>
<p>Users can set <code class="code docutils literal"><span class="pre">includeSangerRead</span></code> parameter to decide to which level the <em>SangerContig</em> report will go. Moreover, after the reports are generated,
users can easily navigate through reports in different levels within the <strong>HTML</strong> file.</p>
<p>One thing to pay attention to is that if users have many reads, it will take quite a long time to write out all reports. If users only want to generate the contig result, remember to set <code class="code docutils literal"><span class="pre">includeSangerRead</span></code> to <code class="code docutils literal"><span class="pre">FALSE</span></code> in order to save time.</p>
<div class="highlight-R"><div class="highlight"><pre><span></span>generateReport<span class="p">(</span>newSangerContig<span class="p">,</span>
               outputDir           <span class="o">=</span> <span class="kp">tempdir</span><span class="p">(),</span>
               includeSangerRead   <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</pre></div>
</div>
<p>Users can access to &#8216;<em>Basic Information</em>&#8216;, &#8216;<em>SangerContig Input Parameters</em>&#8216;, &#8216;<em>Contig Sequence</em>&#8216; and &#8216;<em>Contig Results</em>&#8216; sections inside the generated <a class="reference external" href="https://howardchao.github.io/sangeranalyseR_report/SangerContig/AB1/ACHLO006-09[LCO1490_t1,HCO2198_t1]/SangerContig_Report.html">SangerContig html report of this example</a>. Furthermore, users can also navigate through html reports of all forward and reverse <em>SangerRead</em> in this <em>SangerContig</em> report.</p>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="advance_user_SangerAlignment_ab1.html" class="btn btn-neutral float-right" title="Advanced User Guide - SangerAlignment (AB1)" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="advance_user_SangerRead_ab1.html" class="btn btn-neutral" title="Advanced User Guide - SangerRead (AB1)" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Kuan-Hao Chao.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>