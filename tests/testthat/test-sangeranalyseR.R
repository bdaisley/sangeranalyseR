test_that("SangerRead creation test", {
    expect_equal(2*2, 4)
})


test_that("SangerRead Initial test", {
    # hetab1 <- readsangerseq(system.file("extdata", "heterozygous.ab1", package = "sangerseqR"))
    # makeBaseCalls(hetab1)
    expect_type(A_chloroticaRead, "S4")
    expect_s4_class(A_chloroticaRead, "SangerRead")
    expect_equal(A_chloroticaRead@readFeature, "Forward Read")
    expect_equal(basename(A_chloroticaRead@readFileName), "ACHLO006-09[LCO1490_t1,HCO2198_t1]_F_1.ab1")
    expect_equal(as.character(A_chloroticaRead@primarySeq), "CACTTTATATTTTATTCTGGGCGTCTGAGCAGGAATGGTTGGAGCCGGTATAAGACTTCTAATTCGAATCGAGCTAAGACAACCAGGAGCGTTCCTGGGCAGAGACCAACTATACAATACTATCGTTACTGCACACGCATTTGTAATAATCTTCTTTCTAGTAATGCCTGTATTCATCGGGGGATTCGGAAACTGGCTTTTACCTTTAATACTTGGAGCCCCCGATATAGCATTCCCTCGACTCAACAACATGAGATTCTGACTACTTCCCCCATCACTGATCCTTTTAGTGTCCTCTGCGGCGGTAGAAAAAGGCGCTGGTACGGGGTGAACTGTTTATCCGCCTCTAGCAAGAAATCTTGCCCACGCAGGCCCGTCTGTAGATTTAGCCATCTTTTCCCTTCATTTAGCGGGTGCGTCTTCTATTCTAGGGGCTATTAATTTTATCACCACAGTTATTAATATGCGTTGAAGAGGATTACGTCTTGAACGAATTCCCCTGTTTGTCTGAGCTGTGCTAATTACAGTTGTTCTTCTACTTCTATCTTTACCAGTGCTAGCAGGTGCCATTACCATACTTCTTACCGACCGAAACCTCAATACTTCATTCTTTGATCCTGCCGGTGGTGGAGACCCCATCCTCTACTAGCACTTATTCTGATTTTTAGATCACCCTGATGTTGAGTCATACTGAATTCCTGA")
    expect_equal(as.character(A_chloroticaRead@secondarySeq), "TACTTTATATTTTATTCTGGGCGTCTGAGCAGGAATGGTTGGAGCCGGTATAAGACTTCTAATTCGAATCGAGCTAAGACAACCAGGAGCGTTCCTGGGCAGAGACCAACTATACAATACTATCGTTACTGCACACGCATTTGTAATAATCTTCTTTCTAGTAATGCCTGTATTCATCGGGGGATTCGGAAACTGGCTTTTACCTTTAATACTTGGAGCCCCCGATATAGCATTCCCTCGACTCAACAACATGAGATTCTGACTACTTCCCCCATCACTGATCCTTTTAGTGTCCTCTGCGGCGGTAGAAAAAGGCGCTGGTACGGGGTGAACTGTTTATCCGCCTCTAGCAAGAAATCTTGCCCACGCAGGCCCGTCTGTAGATTTAGCCATCTTTTCCCTTCATTTAGCGGGTGCGTCTTCTATTCTAGGGGCTATTAATTTTATCACCACAGTTATTAATATGCGTTGAAGAGGATTACGTCTTGAACGAATTCCCCTGTTTGTCTGAGCTGTGCTAATTACAGTTGTTCTTCTACTTCTATCTTTACCAGTGCTAGCAGGTGCCATTACCATACTTCTTACCGACCGAAACCTCAATACTTCATTCTTTGATCCTGCCGGTGGTGGAGACCCCATCCTCTACTAGCACTTATTCTGATTTTTCGATCACCCTGATGTTGAGTCATAGTGAATTCCTGA")
    expect_equal(as.character(A_chloroticaRead@primaryAASeqS1), "HFIFYSGRLSRNGWSRYKTSNSNRAKTTRSVPGQRPTIQYYRYCTRICNNLLSSNACIHRGIRKLAFTFNTWSPRYSIPSTQQHEILTTSPITDPFSVLCGGRKRRWYGVNCLSASSKKSCPRRPVCRFSHLFPSFSGCVFYSRGY*FYHHSY*YALKRITS*TNSPVCLSCANYSCSSTSIFTSASRCHYHTSYRPKPQYFIL*SCRWWRPHPLLALILIFRSP*C*VILNS*")
    expect_equal(as.character(A_chloroticaRead@primaryAASeqS2), "TLYFILGV*AGMVGAGIRLLIRIELRQPGAFLGRDQLYNTIVTAHAFVIIFFLVMPVFIGGFGNWLLPLILGAPDIAFPRLNNMRF*LLPPSLILLVSSAAVEKGAGTG*TVYPPLARNLAHAGPSVDLAIFSLHLAGASSILGAINFITTVINMR*RGLRLERIPLFV*AVLITVVLLLLSLPVLAGAITILLTDRNLNTSFFDPAGGGDPILY*HLF*FLDHPDVESY*IP")
    expect_equal(as.character(A_chloroticaRead@primaryAASeqS3), "LYILFWASEQEWLEPV*DF*FESS*DNQERSWAETNYTILSLLHTHL**SSF**CLYSSGDSETGFYL*YLEPPI*HSLDSTT*DSDYFPHH*SF*CPLRR*KKALVRGELFIRL*QEILPTQARL*I*PSFPFI*RVRLLF*GLLILSPQLLICVEEDYVLNEFPCLSELC*LQLFFYFYLYQC*QVPLPYFLPTETSILHSLILPVVETPSSTSTYSDF*ITLMLSHTEFL")
    expect_equal(A_chloroticaRead@ChromatogramParam@baseNumPerRow, 100)
    expect_equal(A_chloroticaRead@ChromatogramParam@heightPerRow, 200)
    expect_equal(A_chloroticaRead@ChromatogramParam@signalRatioCutoff, 0.33)
    expect_equal(A_chloroticaRead@ChromatogramParam@showTrimmed, TRUE)

    expect_equal(A_chloroticaRead@QualityReport@TrimmingMethod, "M1")
    expect_equal(A_chloroticaRead@QualityReport@M1TrimmingCutoff, 0.0001, tolerance=1e-6)
    expect_equal(A_chloroticaRead@QualityReport@M2CutoffQualityScore, NULL)
    expect_equal(A_chloroticaRead@QualityReport@M2SlidingWindowSize, NULL)
    expect_equal(length(A_chloroticaRead@QualityReport@qualityPhredScoresRaw), 703)
    expect_equal(length(A_chloroticaRead@QualityReport@qualityPhredScores), 702)
    expect_equal(length(A_chloroticaRead@QualityReport@qualityBaseScores), 702)

    expect_equal(A_chloroticaRead@QualityReport@rawSeqLength, 702)
    expect_equal(A_chloroticaRead@QualityReport@trimmedSeqLength, 461)
    expect_equal(A_chloroticaRead@QualityReport@trimmedStartPos, 16)
    expect_equal(A_chloroticaRead@QualityReport@trimmedFinishPos, 477)
    expect_equal(A_chloroticaRead@QualityReport@rawMeanQualityScore, 52.87607, tolerance=1e-6)
    expect_equal(A_chloroticaRead@QualityReport@trimmedMeanQualityScore, 58.20779, tolerance=1e-6)
    expect_equal(A_chloroticaRead@QualityReport@rawMinQualityScore, 1)
    expect_equal(A_chloroticaRead@QualityReport@trimmedMinQualityScore, 13)
    expect_equal(A_chloroticaRead@QualityReport@remainingRatio, 0.6566952, tolerance=1e-6)
})

